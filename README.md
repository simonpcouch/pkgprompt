
<!-- README.md is generated from README.Rmd. Please edit that file -->

# pkgprompt

<!-- badges: start -->

[![Lifecycle:
experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
[![CRAN
status](https://www.r-pkg.org/badges/version/pkgprompt)](https://CRAN.R-project.org/package=pkgprompt)
<!-- badges: end -->

Information in a large language model’s prompt is analogous to its
short-term memory; models will provide more informative answerson
problem contexts that they’ve been prompted on, even if the same
information was in the training data. This package converts R package
documentation to LLM-readable plain text to facilitate passing it as
part of a prompt.

## Installation

You can install the development version of pkgprompt like so:

``` r
pak::pak("simonpcouch/pkgprompt")
```

## Example

Pass the name of a package to grab all of its documentation as plain
text:

``` r
library(pkgprompt)

pkg_prompt(pkg = "splines")
```

    #> [1] "# Documentation for the splines package\n\n## Coerce an Object to a Vector\n\nThis is a generic function. Methods for this function coerce objects of given classes to vectors.\n\n```r\nasVector(object)\n```\n\n### Arguments\n\n- `object`: An object.\n\n### Details\n\nMethods for vector coercion in new classes must be created for the `asVector` generic instead of `as.vector`. The `as.vector` function is internal and not easily extended. Currently the only class with an `asVector` method is the `xyVector` class.\n\n### Returns\n\na vector\n\n### Author(s)\n\nDouglas Bates and Bill Venables\n\n### See Also\n\n`xyVector`\n\n### Examples\n\n```r\nrequire(stats)\nispl <- interpSpline( weight ~ height,  women )\npred <- predict(ispl)\nclass(pred)\nutils::str(pred)\nasVector(pred)\n```\n\n## Monotone Inverse Spline\n\nCreate a monotone inverse of a monotone natural spline.\n\n```r\nbackSpline(object)\n```\n\n### Arguments\n\n- `object`: an object that inherits from class `nbSpline` or `npolySpline`. That is, the object must represent a natural interpolation spline but it can be either in the B-spline representation or the piecewise polynomial one. The spline is checked to see if it represents a monotone function.\n\n### Returns\n\nAn object of class `polySpline` that contains the piecewise polynomial representation of a function that has the appropriate values and derivatives at the knot positions to be an inverse of the spline represented by `object`. Technically this object is not a spline because the second derivative is not constrained to be continuous at the knot positions. However, it is often a much better approximation to the inverse than fitting an interpolation spline to the y/x pairs.\n\n### Author(s)\n\nDouglas Bates and Bill Venables\n\n### See Also\n\n`interpSpline`\n\n### Examples\n\n```r\nrequire(graphics)\nispl <- interpSpline( women$height, women$weight )\nbspl <- backSpline( ispl )\nplot( bspl )                   ## plots over the range of the knots\npoints( women$weight, women$height )\n```\n\n## B-Spline Basis for Polynomial Splines\n\nGenerate the B-spline basis matrix for a polynomial spline.\n\n```r\nbs(x, df = NULL, knots = NULL, degree = 3, intercept = FALSE,\n   Boundary.knots = range(x), warn.outside = TRUE)\n```\n\n### Arguments\n\n- `x`: the predictor variable. Missing values are allowed.\n- `df`: degrees of freedom; one can specify `df` rather than `knots`; `bs()` then chooses `df-degree` (minus one if there is an intercept) knots at suitable quantiles of `x`\n    \n    (which will ignore missing values). The default, `NULL`, takes the number of inner knots as `length(knots)`. If that is zero as per default, that corresponds to `df = degree - intercept`.\n- `knots`: the **internal** breakpoints that define the spline. The default is `NULL`, which results in a basis for ordinary polynomial regression. Typical values are the mean or median for one knot, quantiles for more knots. See also `Boundary.knots`.\n- `degree`: degree of the piecewise polynomial---default is `3` for cubic splines.\n- `intercept`: if `TRUE`, an intercept is included in the basis; default is `FALSE`.\n- `Boundary.knots`: boundary points at which to anchor the B-spline basis (default the range of the non-`NA` data). If both `knots` and `Boundary.knots` are supplied, the basis parameters do not depend on `x`. Data can extend beyond `Boundary.knots`.\n- `warn.outside`: `logical` indicating if a `warning` should be signalled in case some `x` values are outside the boundary knots.\n\n### Details\n\n`bs` is based on the function `splineDesign`. It generates a basis matrix for representing the family of piecewise polynomials with the specified interior knots and degree, evaluated at the values of `x`. A primary use is in modeling formulas to directly specify a piecewise polynomial term in a model.\n\nWhen `Boundary.knots` are set **inside** `range(x)`, `bs()` now uses a pivot inside the respective boundary knot which is important for derivative evaluation. In versions `<=` 3.2.2, the boundary knot itself had been used as pivot, which lead to somewhat wrong extrapolations.\n\n### Returns\n\nA matrix of dimension `c(length(x), df)`, where either `df`\n\nwas supplied or if `knots` were supplied, `df = length(knots) + degree` plus one if there is an intercept. Attributes are returned that correspond to the arguments to `bs`, and explicitly give the `knots`, `Boundary.knots` etc for use by `predict.bs()`.\n\n### Author(s)\n\nDouglas Bates and Bill Venables. Tweaks by R Core, and a patch fixing extrapolation outside `Boundary.knots` by Trevor Hastie.\n\n### References\n\nHastie, T. J. (1992) Generalized additive models. Chapter 7 of **Statistical Models in S**\n\neds J. M. Chambers and T. J. Hastie, Wadsworth & Brooks/Cole.\n\n### See Also\n\n`ns`, `poly`, `smooth.spline`, `predict.bs`, `SafePrediction`\n\n### Examples\n\n```r\nrequire(stats); require(graphics)\nbs(women$height, df = 5)\nsummary(fm1 <- lm(weight ~ bs(height, df = 5), data = women))\n\n### example of safe prediction\nplot(women, xlab = \"Height (in)\", ylab = \"Weight (lb)\")\nht <- seq(57, 73, length.out = 200)\nlines(ht, predict(fm1, data.frame(height = ht)))\n```\n\n## Create an Interpolation Spline\n\nCreate an interpolation spline, either from `x` and `y`\n\nvectors (`default` method), or from a `formula` / `data.frame`\n\ncombination (`formula` method).\n\n```r\ninterpSpline(obj1, obj2, bSpline = FALSE, period = NULL,\n             ord = 4L,\n             na.action = na.fail, sparse = FALSE)\n```\n\n### Arguments\n\n- `obj1`: either a numeric vector of `x` values or a formula.\n- `obj2`: if `obj1` is numeric this should be a numeric vector of the same length. If `obj1` is a formula this can be an optional data frame in which to evaluate the names in the formula.\n- `bSpline`: if `TRUE` the b-spline representation is returned, otherwise the piecewise polynomial representation is returned. Defaults to `FALSE`.\n- `period`: an optional positive numeric value giving a period for a periodic interpolation spline.\n- `ord`: an integer specifying the spline **order**, the number of coefficients per interval. `ord = d+1` where `d` is the **degree** polynomial degree. Currently, only cubic splines (`ord = 4`) are implemented.\n- `na.action`: a optional function which indicates what should happen when the data contain `NA`s. The default action (`na.omit`) is to omit any incomplete observations. The alternative action `na.fail` causes `interpSpline` to print an error message and terminate if there are any incomplete observations.\n- `sparse`: logical passed to the underlying `splineDesign`. If true, saves memory and is faster when there are more than a few hundred points.\n\n### Returns\n\nAn object that inherits from (S3) class `spline`. The object can be in the B-spline representation, in which case it will be of class `nbSpline` for natural B-spline, or in the piecewise polynomial representation, in which case it will be of class `npolySpline`.\n\n### Author(s)\n\nDouglas Bates and Bill Venables\n\n### See Also\n\n`splineKnots`, `splineOrder`, `periodicSpline`.\n\n### Examples\n\n```r\nrequire(graphics); require(stats)\nispl <- interpSpline( women$height, women$weight )\nispl2 <- interpSpline( weight ~ height,  women )\n## ispl and ispl2 should be the same\nplot( predict( ispl, seq( 55, 75, length.out = 51 ) ), type = \"l\" )\npoints( women$height, women$weight )\nplot( ispl )    ## plots over the range of the knots\npoints( women$height, women$weight )\nsplineKnots( ispl )\n```\n\n## Generate a Basis Matrix for Natural Cubic Splines\n\nGenerate the B-spline basis matrix for a natural cubic spline.\n\n```r\nns(x, df = NULL, knots = NULL, intercept = FALSE,\n   Boundary.knots = range(x))\n```\n\n### Arguments\n\n- `x`: the predictor variable. Missing values are allowed.\n- `df`: degrees of freedom. One can supply `df` rather than knots; `ns()` then chooses `df - 1 - intercept` knots at suitably chosen quantiles of `x` (which will ignore missing values). The default, `df = NULL`, sets the number of inner knots as `length(knots)`.\n- `knots`: breakpoints that define the spline. The default is no knots; together with the natural boundary conditions this results in a basis for linear regression on `x`. Typical values are the mean or median for one knot, quantiles for more knots. See also `Boundary.knots`.\n- `intercept`: if `TRUE`, an intercept is included in the basis; default is `FALSE`.\n- `Boundary.knots`: boundary points at which to impose the natural boundary conditions and anchor the B-spline basis (default the range of the data). If both `knots` and `Boundary.knots` are supplied, the basis parameters do not depend on `x`. Data can extend beyond `Boundary.knots`\n\n### Details\n\n`ns` is based on the function `splineDesign`. It generates a basis matrix for representing the family of piecewise-cubic splines with the specified sequence of interior knots, and the natural boundary conditions. These enforce the constraint that the function is linear beyond the boundary knots, which can either be supplied or default to the extremes of the data.\n\nA primary use is in modeling formula to directly specify a natural spline term in a model: see the examples.\n\n### Returns\n\nA matrix of dimension `length(x) * df` where either `df` was supplied or if `knots` were supplied, `df = length(knots) + 1 + intercept`. Attributes are returned that correspond to the arguments to `ns`, and explicitly give the `knots`, `Boundary.knots` etc for use by `predict.ns()`.\n\n### References\n\nHastie, T. J. (1992) Generalized additive models. Chapter 7 of **Statistical Models in S**\n\neds J. M. Chambers and T. J. Hastie, Wadsworth & Brooks/Cole.\n\n### See Also\n\n`bs`, `predict.ns`, `SafePrediction`\n\n### Examples\n\n```r\nrequire(stats); require(graphics)\nns(women$height, df = 5)\nsummary(fm1 <- lm(weight ~ ns(height, df = 5), data = women))\n\n### To see what knots were selected\nattr(terms(fm1), \"predvars\")\n\n### example of safe prediction\nplot(women, xlab = \"Height (in)\", ylab = \"Weight (lb)\")\nht <- seq(57, 73, length.out = 200) ; nD <- data.frame(height = ht)\nlines(ht, p1 <- predict(fm1, nD))\nstopifnot(all.equal(p1, predict(update(fm1, . ~\n                            splines::ns(height, df=5)), nD)))\n          ## not true in R < 3.5.0\n```\n\n## Create a Periodic Interpolation Spline\n\nCreate a periodic interpolation spline, either from `x` and `y` vectors, or from a formula/data.frame combination.\n\n```r\nperiodicSpline(obj1, obj2, knots, period = 2*pi, ord = 4L)\n```\n\n### Arguments\n\n- `obj1`: either a numeric vector of `x` values or a formula.\n- `obj2`: if `obj1` is numeric this should be a numeric vector of the same length. If `obj1` is a formula this can be an optional data frame in which to evaluate the names in the formula.\n- `knots`: optional numeric vector of knot positions.\n- `period`: positive numeric value giving the period for the periodic spline. Defaults to `2 * pi`.\n- `ord`: integer giving the order of the spline, at least 2. Defaults to 4. See `splineOrder` for a definition of the order of a spline.\n\n### Returns\n\nAn object that inherits from class `spline`. The object can be in the B-spline representation, in which case it will be a `pbSpline` object, or in the piecewise polynomial representation (a `ppolySpline` object).\n\n### Author(s)\n\nDouglas Bates and Bill Venables\n\n### See Also\n\n`splineKnots`, `interpSpline`\n\n### Examples\n\n```r\nrequire(graphics); require(stats)\nxx <- seq( -pi, pi, length.out = 16 )[-1]\nyy <- sin( xx )\nfrm <- data.frame( xx, yy )\npispl <- periodicSpline( xx, yy, period = 2 * pi)\npispl\npispl2 <- periodicSpline( yy ~ xx, frm, period = 2 * pi )\nstopifnot(all.equal(pispl, pispl2))  ## pispl and pispl2 are the same\n\nplot( pispl )          ## displays over one period\npoints( yy ~ xx, col = \"brown\")\nplot( predict( pispl, seq(-3*pi, 3*pi, length.out = 101) ), type = \"l\" )\n```\n\n## Piecewise Polynomial Spline Representation\n\nCreate the piecewise polynomial representation of a spline object.\n\n```r\npolySpline(object, ...)\nas.polySpline(object, ...)\n```\n\n### Arguments\n\n- `object`: An object that inherits from class `spline`.\n- ``...``: Optional additional arguments. At present no additional arguments are used.\n\n### Returns\n\nAn object that inherits from class `polySpline`. This is the piecewise polynomial representation of a univariate spline function. It is defined by a set of distinct numeric values called knots. The spline function is a polynomial function between each successive pair of knots. At each interior knot the polynomial segments on each side are constrained to have the same value of the function and some of its derivatives.\n\n### Author(s)\n\nDouglas Bates and Bill Venables\n\n### See Also\n\n`interpSpline`, `periodicSpline`, `splineKnots`, `splineOrder`\n\n### Examples\n\n```r\nrequire(graphics)\nispl <- polySpline(interpSpline( weight ~ height,  women, bSpline = TRUE))\n\nprint( ispl )   ## print the piecewise polynomial representation\n\nplot( ispl )    ## plots over the range of the knots\npoints( women$height, women$weight )\n```\n\n## Evaluate a Spline at New Values of x\n\nThe `predict` methods for the classes that inherit from the virtual classes `bSpline` and `polySpline` are used to evaluate the spline or its derivatives. The `plot` method for a spline object first evaluates `predict` with the `x`\n\nargument missing, then plots the resulting `xyVector` with `type = \"l\"`.\n\n```r\n### S3 method for class 'bSpline'\npredict(object, x, nseg = 50, deriv = 0, ...)\n### S3 method for class 'nbSpline'\npredict(object, x, nseg = 50, deriv = 0, ...)\n### S3 method for class 'pbSpline'\npredict(object, x, nseg = 50, deriv = 0, ...)\n### S3 method for class 'npolySpline'\npredict(object, x, nseg = 50, deriv = 0, ...)\n### S3 method for class 'ppolySpline'\npredict(object, x, nseg = 50, deriv = 0, ...)\n```\n\n### Arguments\n\n- `object`: An object that inherits from the `bSpline` or the `polySpline` class.\n- `x`: A numeric vector of `x` values at which to evaluate the spline. If this argument is missing a suitable set of `x`\n    \n    values is generated as a sequence of `nseq` segments spanning the range of the knots.\n- `nseg`: A positive integer giving the number of segments in a set of equally-spaced `x` values spanning the range of the knots in `object`. This value is only used if `x` is missing.\n- `deriv`: An integer between 0 and `splineOrder(object) - 1`\n    \n    specifying the derivative to evaluate.\n- ``...``: further arguments passed to or from other methods.\n\n### Returns\n\nan `xyVector` with components - **x**: the supplied or inferred numeric vector of `x` values\n\n - **y**: the value of the spline (or its `deriv`'th derivative) at the `x` vector\n\n### Author(s)\n\nDouglas Bates and Bill Venables\n\n### See Also\n\n`xyVector`, `interpSpline`, `periodicSpline`\n\n### Examples\n\n```r\nrequire(graphics); require(stats)\nispl <- interpSpline( weight ~ height,  women )\nopar <- par(mfrow = c(2, 2), las = 1)\nplot(predict(ispl, nseg = 201),     ## plots over the range of the knots\n     main = \"Original data with interpolating spline\", type = \"l\",\n     xlab = \"height\", ylab = \"weight\")\npoints(women$height, women$weight, col = 4)\nplot(predict(ispl, nseg = 201, deriv = 1),\n     main = \"First derivative of interpolating spline\", type = \"l\",\n     xlab = \"height\", ylab = \"weight\")\nplot(predict(ispl, nseg = 201, deriv = 2),\n     main = \"Second derivative of interpolating spline\", type = \"l\",\n     xlab = \"height\", ylab = \"weight\")\nplot(predict(ispl, nseg = 401, deriv = 3),\n     main = \"Third derivative of interpolating spline\", type = \"l\",\n     xlab = \"height\", ylab = \"weight\")\npar(opar)\n```\n\n## Evaluate a Spline Basis\n\nEvaluate a predefined spline basis at given values.\n\n```r\n### S3 method for class 'bs'\npredict(object, newx, ...)\n\n### S3 method for class 'ns'\npredict(object, newx, ...)\n```\n\n### Arguments\n\n- `object`: the result of a call to `bs` or `ns` having attributes describing `knots`, `degree`, etc.\n- `newx`: the `x` values at which evaluations are required.\n- ``...``: Optional additional arguments. At present no additional arguments are used.\n\n### Returns\n\nAn object just like `object`, except evaluated at the new values of `x`.\n\nThese are methods for the generic function `predict` for objects inheriting from classes `\"bs\"` or `\"ns\"`. See `predict` for the general behavior of this function.\n\n### See Also\n\n`bs`, `ns`, `poly`.\n\n### Examples\n\n```r\nrequire(stats)\nbasis <- ns(women$height, df = 5)\nnewX <- seq(58, 72, length.out = 51)\n## evaluate the basis at the new data\npredict(basis, newX)\n```\n\n## Design Matrix for B-splines\n\nEvaluate the design matrix for the B-splines defined by `knots`\n\nat the values in `x`.\n\n```r\nsplineDesign(knots, x, ord = 4, derivs, outer.ok = FALSE,\n             sparse = FALSE)\nspline.des  (knots, x, ord = 4, derivs, outer.ok = FALSE,\n             sparse = FALSE)\n```\n\n### Arguments\n\n- `knots`: a numeric vector of knot positions (which will be sorted increasingly if needed).\n- `x`: a numeric vector of values at which to evaluate the B-spline functions or derivatives. Unless `outer.ok` is true, the values in `x` must be between the inner knots `knots[ord]` and `knots[ length(knots) - (ord-1)]`.\n- `ord`: a positive integer giving the order of the spline function. This is the number of coefficients in each piecewise polynomial segment, thus a cubic spline has order 4. Defaults to 4.\n- `derivs`: an integer vector with values between `0` and `ord - 1`, conceptually recycled to the length of `x`. The derivative of the given order is evaluated at the `x`\n    \n    positions. Defaults to zero (or a vector of zeroes of the same length as `x`).\n- `outer.ok`: logical indicating if `x` should be allowed outside the **inner** knots, see the `x` argument.\n- `sparse`: logical indicating if the result should inherit from class `\"sparseMatrix\"` (from package [list(\"Matrix\")](https://CRAN.R-project.org/package=Matrix)).\n\n\n\n### Returns\n\nA matrix with `length(x)` rows and `length(knots) - ord`\n\ncolumns. The i-th row of the matrix contains the coefficients of the B-splines (or the indicated derivative of the B-splines) defined by the `knot` vector and evaluated at the i-th value of `x`. Each B-spline is defined by a set of `ord` successive knots so the total number of B-splines is `length(knots) - ord`.\n\n### Note\n\nThe older `spline.des` function takes the same arguments but returns a list with several components including `knots`, `ord`, `derivs`, and `design`. The `design`\n\ncomponent is the same as the value of the `splineDesign`\n\nfunction.\n\n### Author(s)\n\nDouglas Bates and Bill Venables\n\n### Examples\n\n```r\nrequire(graphics)\nsplineDesign(knots = 1:10, x = 4:7)\nsplineDesign(knots = 1:10, x = 4:7, derivs = 1)\n### visualize band structure\nMatrix::drop0(zapsmall(6*splineDesign(knots = 1:40, x = 4:37, sparse = TRUE)))\n\nknots <- c(1,1.8,3:5,6.5,7,8.1,9.2,10)  ## 10 => 10-4 = 6 Basis splines\nx <- seq(min(knots)-1, max(knots)+1, length.out = 501)\nbb <- splineDesign(knots, x = x, outer.ok = TRUE)\n\nplot(range(x), c(0,1), type = \"n\", xlab = \"x\", ylab = \"\",\n     main =  \"B-splines - sum to 1 inside inner knots\")\nmtext(expression(B[j](x) *\"  and \"* sum(B[j](x), j == 1, 6)), adj = 0)\nabline(v = knots, lty = 3, col = \"light gray\")\nabline(v = knots[c(4,length(knots)-3)], lty = 3, col = \"gray10\")\nlines(x, rowSums(bb), col = \"gray\", lwd = 2)\nmatlines(x, bb, ylim = c(0,1), lty = 1)\n```\n\n## Knot Vector from a Spline\n\nReturn the knot vector corresponding to a spline object.\n\n```r\nsplineKnots(object)\n```\n\n### Arguments\n\n- `object`: an object that inherits from class `\"spline\"`.\n\n### Returns\n\nA non-decreasing numeric vector of knot positions.\n\n### Author(s)\n\nDouglas Bates and Bill Venables\n\n### Examples\n\n```r\nispl <- interpSpline( weight ~ height, women )\nsplineKnots( ispl )\n```\n\n## Determine the Order of a Spline\n\nReturn the order of a spline object.\n\n```r\nsplineOrder(object)\n```\n\n### Arguments\n\n- `object`: An object that inherits from class `\"spline\"`.\n\n### Details\n\nThe order of a spline is the number of coefficients in each piece of the piecewise polynomial representation. Thus a cubic spline has order 4.\n\n### Returns\n\nA positive integer.\n\n### Author(s)\n\nDouglas Bates and Bill Venables\n\n### See Also\n\n`splineKnots`, `interpSpline`, `periodicSpline`\n\n### Examples\n\n```r\nsplineOrder( interpSpline( weight ~ height, women ) )\n```\n\n## Regression Spline Functions and Classes\n\nRegression spline functions and classes.\n\n### Details\n\nThis package provides functions for working with regression splines using the B-spline basis, `bs`, and the natural cubic spline basis, `ns`.\n\nFor a complete list of functions, use `library(help = \"splines\")`.\n\n### Author(s)\n\nDouglas M. Bates bates@stat.wisc.edu and William N. Venables Bill.Venables@csiro.au\n\nMaintainer: R Core Team R-core@r-project.org\n\n## Construct an `xyVector` Object\n\nCreate an object to represent a set of x-y pairs. The resulting object can be treated as a matrix or as a data frame or as a vector. When treated as a vector it reduces to the `y` component only.\n\nThe result of functions such as `predict.spline` is returned as an `xyVector` object so the x-values used to generate the y-positions are retained, say for purposes of generating plots.\n\n```r\nxyVector(x, y)\n```\n\n### Arguments\n\n- `x`: a numeric vector\n- `y`: a numeric vector of the same length as `x`\n\n### Returns\n\nAn object of class `xyVector` with components - **x**: a numeric vector\n\n - **y**: a numeric vector of the same length as `x`\n\n### Author(s)\n\nDouglas Bates and Bill Venables\n\n### Examples\n\n```r\nrequire(stats); require(graphics)\nispl <- interpSpline( weight ~ height, women )\nweights <- predict( ispl, seq( 55, 75, length.out = 51 ))\nclass( weights )\nplot( weights, type = \"l\", xlab = \"height\", ylab = \"weight\" )\npoints( women$height, women$weight )\nweights\n```\n"

You can optionally include only a subset of topics in the package in the
results:

``` r
pkg_prompt(pkg = "splines", topics = c("ns", "bs"))
```

    #> [1] "# Documentation for the splines package\n\n## B-Spline Basis for Polynomial Splines\n\nGenerate the B-spline basis matrix for a polynomial spline.\n\n```r\nbs(x, df = NULL, knots = NULL, degree = 3, intercept = FALSE,\n   Boundary.knots = range(x), warn.outside = TRUE)\n```\n\n### Arguments\n\n- `x`: the predictor variable. Missing values are allowed.\n- `df`: degrees of freedom; one can specify `df` rather than `knots`; `bs()` then chooses `df-degree` (minus one if there is an intercept) knots at suitable quantiles of `x`\n    \n    (which will ignore missing values). The default, `NULL`, takes the number of inner knots as `length(knots)`. If that is zero as per default, that corresponds to `df = degree - intercept`.\n- `knots`: the **internal** breakpoints that define the spline. The default is `NULL`, which results in a basis for ordinary polynomial regression. Typical values are the mean or median for one knot, quantiles for more knots. See also `Boundary.knots`.\n- `degree`: degree of the piecewise polynomial---default is `3` for cubic splines.\n- `intercept`: if `TRUE`, an intercept is included in the basis; default is `FALSE`.\n- `Boundary.knots`: boundary points at which to anchor the B-spline basis (default the range of the non-`NA` data). If both `knots` and `Boundary.knots` are supplied, the basis parameters do not depend on `x`. Data can extend beyond `Boundary.knots`.\n- `warn.outside`: `logical` indicating if a `warning` should be signalled in case some `x` values are outside the boundary knots.\n\n### Details\n\n`bs` is based on the function `splineDesign`. It generates a basis matrix for representing the family of piecewise polynomials with the specified interior knots and degree, evaluated at the values of `x`. A primary use is in modeling formulas to directly specify a piecewise polynomial term in a model.\n\nWhen `Boundary.knots` are set **inside** `range(x)`, `bs()` now uses a pivot inside the respective boundary knot which is important for derivative evaluation. In versions `<=` 3.2.2, the boundary knot itself had been used as pivot, which lead to somewhat wrong extrapolations.\n\n### Returns\n\nA matrix of dimension `c(length(x), df)`, where either `df`\n\nwas supplied or if `knots` were supplied, `df = length(knots) + degree` plus one if there is an intercept. Attributes are returned that correspond to the arguments to `bs`, and explicitly give the `knots`, `Boundary.knots` etc for use by `predict.bs()`.\n\n### Author(s)\n\nDouglas Bates and Bill Venables. Tweaks by R Core, and a patch fixing extrapolation outside `Boundary.knots` by Trevor Hastie.\n\n### References\n\nHastie, T. J. (1992) Generalized additive models. Chapter 7 of **Statistical Models in S**\n\neds J. M. Chambers and T. J. Hastie, Wadsworth & Brooks/Cole.\n\n### See Also\n\n`ns`, `poly`, `smooth.spline`, `predict.bs`, `SafePrediction`\n\n### Examples\n\n```r\nrequire(stats); require(graphics)\nbs(women$height, df = 5)\nsummary(fm1 <- lm(weight ~ bs(height, df = 5), data = women))\n\n### example of safe prediction\nplot(women, xlab = \"Height (in)\", ylab = \"Weight (lb)\")\nht <- seq(57, 73, length.out = 200)\nlines(ht, predict(fm1, data.frame(height = ht)))\n```\n\n## Generate a Basis Matrix for Natural Cubic Splines\n\nGenerate the B-spline basis matrix for a natural cubic spline.\n\n```r\nns(x, df = NULL, knots = NULL, intercept = FALSE,\n   Boundary.knots = range(x))\n```\n\n### Arguments\n\n- `x`: the predictor variable. Missing values are allowed.\n- `df`: degrees of freedom. One can supply `df` rather than knots; `ns()` then chooses `df - 1 - intercept` knots at suitably chosen quantiles of `x` (which will ignore missing values). The default, `df = NULL`, sets the number of inner knots as `length(knots)`.\n- `knots`: breakpoints that define the spline. The default is no knots; together with the natural boundary conditions this results in a basis for linear regression on `x`. Typical values are the mean or median for one knot, quantiles for more knots. See also `Boundary.knots`.\n- `intercept`: if `TRUE`, an intercept is included in the basis; default is `FALSE`.\n- `Boundary.knots`: boundary points at which to impose the natural boundary conditions and anchor the B-spline basis (default the range of the data). If both `knots` and `Boundary.knots` are supplied, the basis parameters do not depend on `x`. Data can extend beyond `Boundary.knots`\n\n### Details\n\n`ns` is based on the function `splineDesign`. It generates a basis matrix for representing the family of piecewise-cubic splines with the specified sequence of interior knots, and the natural boundary conditions. These enforce the constraint that the function is linear beyond the boundary knots, which can either be supplied or default to the extremes of the data.\n\nA primary use is in modeling formula to directly specify a natural spline term in a model: see the examples.\n\n### Returns\n\nA matrix of dimension `length(x) * df` where either `df` was supplied or if `knots` were supplied, `df = length(knots) + 1 + intercept`. Attributes are returned that correspond to the arguments to `ns`, and explicitly give the `knots`, `Boundary.knots` etc for use by `predict.ns()`.\n\n### References\n\nHastie, T. J. (1992) Generalized additive models. Chapter 7 of **Statistical Models in S**\n\neds J. M. Chambers and T. J. Hastie, Wadsworth & Brooks/Cole.\n\n### See Also\n\n`bs`, `predict.ns`, `SafePrediction`\n\n### Examples\n\n```r\nrequire(stats); require(graphics)\nns(women$height, df = 5)\nsummary(fm1 <- lm(weight ~ ns(height, df = 5), data = women))\n\n### To see what knots were selected\nattr(terms(fm1), \"predvars\")\n\n### example of safe prediction\nplot(women, xlab = \"Height (in)\", ylab = \"Weight (lb)\")\nht <- seq(57, 73, length.out = 200) ; nD <- data.frame(height = ht)\nlines(ht, p1 <- predict(fm1, nD))\nstopifnot(all.equal(p1, predict(update(fm1, . ~\n                            splines::ns(height, df=5)), nD)))\n          ## not true in R < 3.5.0\n```\n"
